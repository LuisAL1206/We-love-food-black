{"ast":null,"code":"import _defineProperty from \"/Users/AL1206/Desktop/35_frontend/b35-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport _slicedToArray from \"/Users/AL1206/Desktop/35_frontend/b35-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nimport _taggedTemplateLiteral from \"/Users/AL1206/Desktop/35_frontend/b35-frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral\";\nvar _jsxFileName = \"/Users/AL1206/Desktop/35_frontend/b35-frontend/src/views/Update.js\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(source, true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(source).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _templateObject2() {\n  const data = _taggedTemplateLiteral([\"\\n    query getOnePost($id:ID!){\\n        getSinglePost(id:$id){\\n            title\\n            content\\n            cover\\n        }\\n    }\\n\"]);\n\n  _templateObject2 = function () {\n    return data;\n  };\n\n  return data;\n}\n\nfunction _templateObject() {\n  const data = _taggedTemplateLiteral([\"\\n    mutation updatePost($id: ID!, $data: PostUpdateInput!) {\\n        updateOnePost(id:$id ,data: $data) {\\n            _id\\n        }\\n    }\\n\"]);\n\n  _templateObject = function () {\n    return data;\n  };\n\n  return data;\n}\n\nimport React, { useState } from 'react';\nimport { useMutation, useQuery } from 'react-apollo-hooks';\nimport gql from 'graphql-tag';\nimport Layout from '../common/Layout';\nimport Input from '../common/Input';\nimport useForm from '../hooks/useForm';\nimport authHOC from '../utils/authHOC';\nconst UPDATE_POST = gql(_templateObject());\nconst GET_POST = gql(_templateObject2());\n\nfunction Update({\n  match,\n  history\n}) {\n  const _useMutation = useMutation(UPDATE_POST),\n        _useMutation2 = _slicedToArray(_useMutation, 1),\n        sendPost = _useMutation2[0];\n\n  const _useState = useState(''),\n        _useState2 = _slicedToArray(_useState, 2),\n        cover = _useState2[0],\n        setCover = _useState2[1];\n\n  const _useState3 = useState(''),\n        _useState4 = _slicedToArray(_useState3, 2),\n        coverPreview = _useState4[0],\n        setCoverPreview = _useState4[1];\n\n  const query = useQuery(GET_POST, {\n    variables: {\n      id: match.params.id\n    }\n  });\n\n  const catchCover = event => {\n    const reader = new FileReader();\n    const file = event.target.files[0];\n\n    reader.onloadend = () => {\n      setCover(file);\n      setCoverPreview(reader.result);\n    };\n\n    reader.readAsDataURL(file);\n  };\n\n  const catchData = async inputs => {\n    delete inputs.cover;\n    const newData = cover ? _objectSpread({}, inputs, {\n      cover\n    }) : _objectSpread({}, inputs);\n\n    const _ref = await sendPost({\n      variables: {\n        id: match.params.id,\n        data: newData\n      }\n    }),\n          data = _ref.data,\n          errors = _ref.errors;\n\n    if (data) history.push('/');\n    if (errors) alert(\"Errores: \".concat(errors));\n  };\n\n  const _useForm = useForm(catchData, query.data),\n        inputs = _useForm.inputs,\n        handleSubmit = _useForm.handleSubmit,\n        handleInputChange = _useForm.handleInputChange;\n\n  if (query.loading) return React.createElement(\"h2\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 74\n    },\n    __self: this\n  }, \"Carrgando...\");\n  return React.createElement(React.Fragment, null, React.createElement(Layout, {\n    head: \"Modifica tu post de postealo!\",\n    subhead: \"Comparte todo lo que gustes aqui\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 77\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: \"container\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 79\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: \"row\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 80\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: \"col-lg-8 col-md-10 mx-auto\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 81\n    },\n    __self: this\n  }, React.createElement(\"form\", {\n    onSubmit: handleSubmit,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 82\n    },\n    __self: this\n  }, React.createElement(Input, {\n    name: \"title\",\n    label: \"Titulo: \",\n    type: \"text\",\n    placeholder: \"Titulo del post\",\n    value: inputs.title,\n    change: handleInputChange,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 83\n    },\n    __self: this\n  }), React.createElement(\"div\", {\n    className: \"control-group\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 91\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: \"form-group floating-label-form-group controls\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 92\n    },\n    __self: this\n  }, React.createElement(\"label\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 93\n    },\n    __self: this\n  }, \"Contenido: \"), React.createElement(\"textarea\", {\n    className: \"form-control\",\n    placeholder: \"Contenido del post \",\n    name: \"content\",\n    onChange: handleInputChange,\n    value: inputs.content,\n    cols: \"30\",\n    rows: \"10\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 94\n    },\n    __self: this\n  }))), React.createElement(Input, {\n    name: \"cover\",\n    label: \"Cover: \",\n    type: \"file\",\n    placeholder: \"Selecciona el cover de tu post.\",\n    change: catchCover,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 100\n    },\n    __self: this\n  }), query.data.getSinglePost.cover ? React.createElement(React.Fragment, null, React.createElement(\"h4\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 112\n    },\n    __self: this\n  }, \"Imagen previa\"), React.createElement(\"img\", {\n    src: query.data.getSinglePost.cover,\n    alt: \"\",\n    className: \"d-block w-50\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 113\n    },\n    __self: this\n  })) : React.createElement(React.Fragment, null), React.createElement(\"img\", {\n    src: coverPreview,\n    alt: \"\",\n    className: \"d-block w-50\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 118\n    },\n    __self: this\n  }), React.createElement(\"div\", {\n    className: \"clearfix mt-4\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 120\n    },\n    __self: this\n  }, React.createElement(\"button\", {\n    className: \"btn btn-primary float-right\",\n    type: \"submit\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 121\n    },\n    __self: this\n  }, \"Actualizar post.\"))))))));\n}\n\nexport default authHOC(Update);","map":{"version":3,"sources":["/Users/AL1206/Desktop/35_frontend/b35-frontend/src/views/Update.js"],"names":["React","useState","useMutation","useQuery","gql","Layout","Input","useForm","authHOC","UPDATE_POST","GET_POST","Update","match","history","sendPost","cover","setCover","coverPreview","setCoverPreview","query","variables","id","params","catchCover","event","reader","FileReader","file","target","files","onloadend","result","readAsDataURL","catchData","inputs","newData","data","errors","push","alert","handleSubmit","handleInputChange","loading","title","content","getSinglePost"],"mappings":"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","sourcesContent":["import React, {useState} from 'react';\nimport { useMutation, useQuery } from 'react-apollo-hooks';\nimport gql from 'graphql-tag';\nimport Layout from '../common/Layout';\nimport Input from '../common/Input' \nimport useForm from '../hooks/useForm';\nimport authHOC from '../utils/authHOC';\n\nconst UPDATE_POST = gql `\n    mutation updatePost($id: ID!, $data: PostUpdateInput!) {\n        updateOnePost(id:$id ,data: $data) {\n            _id\n        }\n    }\n`;\n\nconst GET_POST = gql `\n    query getOnePost($id:ID!){\n        getSinglePost(id:$id){\n            title\n            content\n            cover\n        }\n    }\n`;\n\n\nfunction Update({match, history}){\n    const [sendPost] = useMutation(UPDATE_POST);\n    const [cover, setCover] = useState('');\n    const [coverPreview, setCoverPreview] = useState('');\n    \n    const query = useQuery(GET_POST, {\n        variables: {\n            id: match.params.id\n        }\n    });\n\n    const catchCover = event => {\n    const reader = new FileReader();\n    const file = event.target.files[0];\n\n    reader.onloadend = () =>{\n        setCover(file);\n        setCoverPreview(reader.result);\n    } \n\n    reader.readAsDataURL(file);\n\n    }\n\n    const catchData = async (inputs) => {\n        delete inputs.cover;\n        const newData = cover ? { ...inputs, cover}: {...inputs}\n        const {\n            data,\n            errors\n        } = await sendPost({\n                    variables: {\n                        id: match.params.id,\n                        data: newData,\n                    }\n                });\n        if(data) history.push('/');\n        if (errors) alert(`Errores: ${errors}`);\n    }\n\n    const {\n        inputs,\n        handleSubmit,\n        handleInputChange,\n    } = useForm(catchData, query.data);\n\n    if(query.loading) return <h2>Carrgando...</h2>\n\n        return(<>\n         <Layout head = \"Modifica tu post de postealo!\"\n        subhead = \"Comparte todo lo que gustes aqui\" >\n        <div className=\"container\">\n            <div className=\"row\">\n            <div className=\"col-lg-8 col-md-10 mx-auto\">\n                <form onSubmit={handleSubmit}>\n                    <Input\n                    name=\"title\"\n                    label=\"Titulo: \"\n                    type=\"text\"\n                    placeholder=\"Titulo del post\"\n                    value={inputs.title}\n                    change={handleInputChange}\n                    ></Input>\n                    <div className=\"control-group\">\n                            <div className=\"form-group floating-label-form-group controls\">\n                                <label>Contenido: </label>\n                                <textarea className=\"form-control\" \n                                placeholder=\"Contenido del post \"\n                                name=\"content\" onChange={handleInputChange} value={inputs.content} \n                                cols=\"30\" rows=\"10\"></textarea>\n                            </div>\n                        </div>\n                    <Input\n                    name=\"cover\"\n                    label=\"Cover: \"\n                    type=\"file\"\n                    placeholder=\"Selecciona el cover de tu post.\"\n                    change={catchCover}\n\n                    ></Input>\n\n                    {\n                        query.data.getSinglePost.cover ? (\n                            <>\n                            <h4>Imagen previa</h4>\n                            <img src={query.data.getSinglePost.cover} alt=\"\" className=\"d-block w-50\"></img>\n                            </>\n                        ): (<></>)\n                    }\n\n                    <img src={coverPreview} alt=\"\" className=\"d-block w-50\"></img>\n        \n                <div className=\"clearfix mt-4\">\n                    <button className=\"btn btn-primary float-right\" type=\"submit\">\n                        Actualizar post. \n                        </button>\n                </div>\n                </form>\n            </div>\n            </div>\n        </div>\n        </Layout>\n    </>);\n}\n\nexport default authHOC(Update);"]},"metadata":{},"sourceType":"module"}